<%= content_for(:title) do %>
  Days in Turkey
<% end %>

<%= content_for(:description) do %>
  With a tourist visa you can stay in Turkey 90 days every 180 days. When should you leave? Make the math!
<% end %>

<div class="container">
  <div class="row">
    <div class="col-xs-10 col-sm-8 col-sm-offset-2 col-xs-offset-1">

      <h4>Turkey Clock: <%= @time_now %></h4>

        <!-- User is in? -->
        <form action="">
          <div class="form-group">
            <div class="checkbox">
            <strong>Are you in Turkey right now?</strong>
              <label>
                <input type="checkbox" name="check_inside" id="in_turkey" value="Yes" checked>Yes
              </label>
            </div>
          </div>
          <div class="form-group" id="inside_last_entry">
            <label for="last_entry">Latest Entry:</label>
            <input type="text" name="last_entry" id="user_last_entry" class="first_day form-control">
          </div>
          <button type="submit" class="btn btn-success">Save</button>
        </form>

        <!-- User is in? -->

        <!-- Been there before? -->
        <div class="form-group">
          <div class="checkbox">
          <strong>Did you do other stays in Turkey since <%= @oldest_date %> included?</strong>
            <label>
              <input type="checkbox" name="check_previous" id="has_previous_stays" value="Yes" checked>Yes
            </label>
          </div>
        </div>
        <!-- Been there before? -->

        <!-- All previous stays -->
        <div id="all_stays">
          <table class="table tablebordered table-condensed">
            <thead>
              <tr>
                <td>Entry Date</td>
                <td>Exit Date</td>
                <td>Number of Days</td>
              </tr>
            </thead>
            <tbody>
              <% @periods.order(:last_day).each do |p| %>
                <tr data-id="<%= p.id %>">
                  <td><%= p.first_day.strftime("%B %d, %Y") %></td>
                  <td><%= p.last_day.strftime("%B %d, %Y") %></td>
                  <td><%= (p.last_day - p.first_day).to_i + 1 %></td>
                  <td><%= link_to edit_period_path(p), class: "btn btn-primary" do %><i class="fa fa-pencil"></i><% end %> <%= link_to p, method: :delete, data: { confirm: 'Are you sure?' }, class: "btn btn-danger", remote: true do %><i class="fa fa-trash"></i><% end %></td>
                </tr>
              <% end %>
            </tbody>
          </table>
          <div id="new_period_form">
            <%= render "periods/period_form" %>
          </div>
        </div>
        <!-- All previous stays -->

        <br>
        time spent: <%#= @user.time_spent(Date.today) %>
        <br>
        remaining time: <%#= @user.remaining_time %>
        <br>
        You must leave on <%#= @user.latest_exit %> or before
        <br>

    </div>
  </div>
</div>